# Database tables and sample data for SlashData Vehicle Portal

The statements below target MySQL 8 and mirror the JPA entity mappings in the backend. Run them in the order shown to create the
 tables and seed a small set of related records for local development.

## Table creation
```sql
CREATE TABLE users (
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    full_name VARCHAR(150) NOT NULL DEFAULT '',
    email VARCHAR(255) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    password_ VARCHAR(255),
    role VARCHAR(20) NOT NULL,
    status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    last_active DATETIME DEFAULT CURRENT_TIMESTAMP,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE vehicle_types (
    id INT UNSIGNED NOT NULL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    name_ar VARCHAR(100),
    description TEXT,
    description_ar TEXT
);

CREATE TABLE makes (
    id VARCHAR(50) NOT NULL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    name_ar VARCHAR(100)
);

CREATE TABLE models (
    id INT UNSIGNED NOT NULL PRIMARY KEY,
    make_id VARCHAR(50) NOT NULL,
    type_id INT UNSIGNED NOT NULL,
    name VARCHAR(100) NOT NULL,
    name_ar VARCHAR(100),
    CONSTRAINT uq_models_make_name UNIQUE (make_id, name),
    CONSTRAINT fk_models_make FOREIGN KEY (make_id) REFERENCES makes (id),
    CONSTRAINT fk_models_type FOREIGN KEY (type_id) REFERENCES vehicle_types (id)
);

CREATE TABLE adp_master (
    id CHAR(36) NOT NULL PRIMARY KEY,
    adp_make_id VARCHAR(50),
    make_en_desc VARCHAR(200),
    make_ar_desc VARCHAR(200),
    adp_model_id VARCHAR(50),
    model_en_desc VARCHAR(200),
    model_ar_desc VARCHAR(200),
    adp_type_id VARCHAR(50),
    type_en_desc VARCHAR(200),
    type_ar_desc VARCHAR(200)
);

CREATE TABLE adp_make_mappings (
    id CHAR(36) NOT NULL PRIMARY KEY,
    adp_make_id VARCHAR(50) NOT NULL UNIQUE,
    sd_make_id VARCHAR(50) NOT NULL,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_adp_make_mappings_make FOREIGN KEY (sd_make_id) REFERENCES makes (id)
);

CREATE TABLE adp_type_mappings (
    id CHAR(36) NOT NULL PRIMARY KEY,
    adp_type_id VARCHAR(50) NOT NULL UNIQUE,
    sd_type_id INT UNSIGNED NOT NULL,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_adp_type_mappings_type FOREIGN KEY (sd_type_id) REFERENCES vehicle_types (id)
);

CREATE TABLE adp_mappings (
    id CHAR(36) NOT NULL PRIMARY KEY,
    adp_id CHAR(36) NOT NULL,
    make_id VARCHAR(50),
    model_id INT UNSIGNED,
    status VARCHAR(20) NOT NULL DEFAULT 'MAPPED',
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_by BIGINT,
    reviewed_at DATETIME,
    reviewed_by BIGINT,
    CONSTRAINT fk_adp_mappings_adp FOREIGN KEY (adp_id) REFERENCES adp_master (id),
    CONSTRAINT fk_adp_mappings_make FOREIGN KEY (make_id) REFERENCES makes (id),
    CONSTRAINT fk_adp_mappings_model FOREIGN KEY (model_id) REFERENCES models (id),
    CONSTRAINT fk_adp_mappings_updated_by FOREIGN KEY (updated_by) REFERENCES users (id),
    CONSTRAINT fk_adp_mappings_reviewed_by FOREIGN KEY (reviewed_by) REFERENCES users (id)
);

CREATE TABLE adp_mapping_history (
    id CHAR(36) NOT NULL PRIMARY KEY,
    adp_id CHAR(36) NOT NULL,
    mapping_id CHAR(36),
    action VARCHAR(20) NOT NULL,
    details VARCHAR(500),
    user_id BIGINT,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_adp_mapping_history_adp FOREIGN KEY (adp_id) REFERENCES adp_master (id),
    CONSTRAINT fk_adp_mapping_history_mapping FOREIGN KEY (mapping_id) REFERENCES adp_mappings (id),
    CONSTRAINT fk_adp_mapping_history_user FOREIGN KEY (user_id) REFERENCES users (id)
);

CREATE TABLE app_config (
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    enable_ai BOOLEAN DEFAULT FALSE,
    api_key VARCHAR(255) DEFAULT '',
    ai_confidence_threshold DOUBLE DEFAULT 0.0,
    maintenance_mode BOOLEAN DEFAULT FALSE,
    enable_audit_log BOOLEAN DEFAULT FALSE
);
```

## Sample seed data
```sql
-- Users
INSERT INTO users (full_name, email, password_hash, role, status)
VALUES
  ('Admin User', 'admin@example.com', '$2a$10$replaceWithBcryptHash', 'ADMIN', 'ACTIVE'),
  ('Mapping Reviewer', 'reviewer@example.com', '$2a$10$replaceWithBcryptHash', 'MAPPING_ADMIN', 'ACTIVE');

-- Vehicle types
INSERT INTO vehicle_types (id, name, name_ar, description)
VALUES
  (1, 'Sedan', 'سيدان', 'Passenger car'),
  (2, 'SUV', 'دفع رباعي', 'Sport utility vehicle');

-- Makes (manual string IDs)
INSERT INTO makes (id, name, name_ar)
VALUES
  ('TESLA', 'Tesla', 'تسلا'),
  ('TOYOTA', 'Toyota', 'تويوتا');

-- Models (use the manual make IDs above)
INSERT INTO models (id, make_id, type_id, name, name_ar)
VALUES
  (100, 'TESLA', 1, 'Model 3', 'موديل 3'),
  (200, 'TOYOTA', 2, 'RAV4', 'راف فور');

-- ADP master rows
INSERT INTO adp_master (id, adp_make_id, make_en_desc, make_ar_desc, adp_model_id, model_en_desc, model_ar_desc, adp_type_id, type_en_desc, type_ar_desc)
VALUES
  ('55555555-5555-5555-5555-555555555555', 'ADP-MAKE-001', 'Tesla', 'تسلا', 'ADP-MODEL-001', 'Model 3', 'موديل 3', 'ADP-TYPE-001', 'Sedan', 'سيدان'),
  ('66666666-6666-6666-6666-666666666666', 'ADP-MAKE-002', 'Toyota', 'تويوتا', 'ADP-MODEL-002', 'RAV4', 'راف فور', 'ADP-TYPE-002', 'SUV', 'دفع رباعي');

-- ADP make and type mappings
INSERT INTO adp_make_mappings (id, adp_make_id, sd_make_id)
VALUES
  ('77777777-7777-7777-7777-777777777777', 'ADP-MAKE-001', 'TESLA'),
  ('88888888-8888-8888-8888-888888888888', 'ADP-MAKE-002', 'TOYOTA');

INSERT INTO adp_type_mappings (id, adp_type_id, sd_type_id)
VALUES
  ('99999999-9999-9999-9999-999999999999', 'ADP-TYPE-001', 1),
  ('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa', 'ADP-TYPE-002', 2);

-- ADP mappings
INSERT INTO adp_mappings (id, adp_id, make_id, model_id, status, updated_by, reviewed_by)
VALUES
  ('bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb', '55555555-5555-5555-5555-555555555555', 'TESLA', 100, 'MAPPED', 1, 2),
  ('cccccccc-cccc-cccc-cccc-cccccccccccc', '66666666-6666-6666-6666-666666666666', 'TOYOTA', 200, 'MAPPED', 2, 1);

-- ADP mapping history
INSERT INTO adp_mapping_history (id, adp_id, mapping_id, action, details, user_id)
VALUES
  ('dddddddd-dddd-dddd-dddd-dddddddddddd', '55555555-5555-5555-5555-555555555555', 'bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb', 'CREATED', 'Initial mapping created by admin', 1),
  ('eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee', '66666666-6666-6666-6666-666666666666', 'cccccccc-cccc-cccc-cccc-cccccccccccc', 'REVIEWED', 'Mapping reviewed and approved', 2);

-- App configuration
INSERT INTO app_config (enable_ai, api_key, ai_confidence_threshold, maintenance_mode, enable_audit_log)
VALUES (FALSE, '', 0.75, FALSE, TRUE);
```
